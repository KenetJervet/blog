---
title: Tornado源码分析之〇
date: 2017-01-26 13:55:47
tags: 
  - Python
  - Tornado
---

我们总是抱怨CPython太慢，然而不管多慢，CPU还是CPU，比起动辄慢上成千上成倍的I/O来说真心不足挂齿。
所以你一定知道什么时候应该用“非阻塞I/O模型”，什么时候干脆换个编程语言。

JavaScript党喜欢用Node.js装逼，其实Tornado和Node.js是同龄。
然而为什么Tornado没有Node.js名气大呢？
很简单，因为JS党就是喜欢装逼`_(:з」∠)_`，Node.js连广告费都省了。

开个玩笑，其实很多性能测试报告表明，Tornado的性能似乎逊于Node.js。嘛，可以理解，毕竟（此处把第一段划掉）
不慢就不叫CPython。基于PyPy的测试我没怎么找，不过乃们的测试究竟合理嘛啊喂，不是测Hello world就是测
算质数。好好的一个异步非阻塞模型让你们给糟蹋了。你们不是在测框架，只是在拿V8引擎秀优越罢了。

不过仔细想一下，其实一个非常全面的测试还是蛮难做的，Tornado和Node.js提出来，加上一大堆可以替换的IO loop
（自带ioloop、uvloop、asyncio之类），然后Tornado上还可以套其他Web框架比如Django/Flask，单进程Tornado
或nginx X进程，再考虑应用场景比如高/低并发、长短连接，指标上有响应时间、吞吐量、负载，测试空间不知道是几维的，
测试用例数笛卡尔积一算，嗯，还是别做了。

嘛，思想是有了，只要我们知道什么样的模型解决什么样的问题，然后结合别人的使用经验一对照，选出一个合适的框架并非难事。
（有时候我们总是踩着掉进坑里的苦逼们的脑袋前行）

恰巧项目中有一个基于WebSocket的通知机制是使用Tornado实现，所以借着修一个使用tornado.testing实现的单元测试的Bug的机会，
来看一番Tornado的源码。

这个系列的源码分析完全按照我对各个模块的重视程度排列，而非按照目录结构。
